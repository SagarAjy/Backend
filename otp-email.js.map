{"version":3,"file":"otp-email.js","sourceRoot":"","sources":["otp-email.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,oDAAkE;AAClE,qCAAkC;AAElC,oBAAoB;AACpB,MAAM,SAAS,GAAG,IAAI,sBAAS,CAAC;IAC9B,MAAM,EAAE,YAAY;IACpB,WAAW,EAAE;QACX,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,EAAE;QAChD,eAAe,EAAE,OAAO,CAAC,GAAG,CAAC,qBAAqB,IAAI,EAAE;KACzD;CACF,CAAC,CAAC;AAEH,4BAA4B;AACrB,MAAM,SAAS,GAAG,CAAO,EAAE,EAAE,EAAE,GAAG,EAA+B,EAAE,EAAE;IAC1E,oCAAoC;IACpC,MAAM,WAAW,GAAG,oBAAoB,GAAG,EAAE,CAAC;IAC9C,MAAM,QAAQ,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;yDAyBsC,OAAO,CAAC,GAAG,CAAC,QAAQ;;;;;;;;;;;;;;;;kIAgBqD,OAAO,CAAC,GAAG,CAAC,QAAQ;oIAClB,GAAG;gHACvB,EAAE;;;;;;;;;;;;;;;;;;;;;;CAsBjH,CAAC;IAEA,MAAM,QAAQ,GAAG;;;+BAGY,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,GAAG;;4CAEf,EAAE;;;;;CAK7C,CAAC;IAEA,eAAe;IACf,MAAM,MAAM,GAAG;QACb,WAAW,EAAE;YACX,WAAW,EAAE,CAAC,EAAE,CAAC;SAClB;QACD,OAAO,EAAE;YACP,IAAI,EAAE;gBACJ,IAAI,EAAE;oBACJ,OAAO,EAAE,OAAO;oBAChB,IAAI,EAAE,QAAQ;iBACf;gBACD,IAAI,EAAE;oBACJ,OAAO,EAAE,OAAO;oBAChB,IAAI,EAAE,QAAQ;iBACf;aACF;YACD,OAAO,EAAE;gBACP,OAAO,EAAE,OAAO;gBAChB,IAAI,EAAE,WAAW;aAClB;SACF;QACD,MAAM,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE;KAC1C,CAAC;IAEF,mCAAmC;IACnC,MAAM,gBAAgB,GAAG,IAAI,6BAAgB,CAAC,MAAM,CAAC,CAAC;IAEtD,wCAAwC;IACxC,MAAM,SAAS;SACZ,IAAI,CAAC,gBAAgB,CAAC;SACtB,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC;SACjB,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,eAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;AACrC,CAAC,CAAA,CAAC;AAlHW,QAAA,SAAS,aAkHpB;AAEF,OAAO;AACP,oCAAoC;AACpC,0JAA0J;AAC1J,WAAW;AACX,UAAU;AACV,QAAQ","sourcesContent":["import { SESClient, SendEmailCommand } from '@aws-sdk/client-ses';\r\n//import { logger } from './logger';\r\n\r\n// Configure AWS SES\r\nconst sesClient = new SESClient({\r\n  region: 'ap-south-1',\r\n  credentials: {\r\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID || '',\r\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY || '',\r\n  },\r\n});\r\n\r\n// Function to send an email\r\nexport const sendEmail = async ({ to, otp }: { to: string; otp: string }) => {\r\n  // Define the email template content\r\n  const subjectPart = `Your OTP for is: ${otp}`;\r\n  const htmlPart = `\r\n  <!doctype html>\r\n<html lang=\"en-US\">\r\n  <head>\r\n    <meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" />\r\n    <title>OTP</title>\r\n    <meta name=\"description\" content=\"\">\r\n    <style type=\"text/css\">\r\n      a:hover {\r\n        text-decoration: underline !important;\r\n      }\r\n    </style>\r\n  </head>\r\n  <body marginheight=\"0\" topmargin=\"0\" marginwidth=\"0\" style=\"margin: 0px; background-color: #f2f3f8;\" leftmargin=\"0\">\r\n    <!-- 100% body table -->\r\n    <table cellspacing=\"0\" border=\"0\" cellpadding=\"0\" width=\"100%\" bgcolor=\"#f2f3f8\" style=\"@import url(https://fonts.googleapis.com/css?family=Rubik:300,400,500,700|Open+Sans:300,400,600,700); font-family: 'Open Sans', sans-serif;\">\r\n      <tr>\r\n        <td>\r\n          <table style=\"background-color: #f2f3f8; max-width:670px; margin:0 auto;\" width=\"100%\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">\r\n            <tr>\r\n              <td style=\"height:80px;\">&nbsp;</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"text-align:center;\">\r\n                <a href=\"\" title=\"logo\" target=\"_blank\">\r\n                  <img width=\"auto\" heigth=\"64px\" src=\"${process.env.ORG_LOGO}\" title=\"logo\" alt=\"logo\">\r\n                </a>\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"height:20px;\">&nbsp;</td>\r\n            </tr>\r\n            <tr>\r\n              <td>\r\n                <table width=\"95%\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width:670px; background:#fff; border-radius:3px; text-align:center;-webkit-box-shadow:0 6px 18px 0 rgba(0,0,0,.06);-moz-box-shadow:0 6px 18px 0 rgba(0,0,0,.06);box-shadow:0 6px 18px 0 rgba(0,0,0,.06);\">\r\n                  <tr>\r\n                    <td style=\"height:40px;\">&nbsp;</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td style=\"padding:0 35px;\">\r\n                      <h1 style=\"color:#1e1e2d; font-weight:500; margin:0;font-size:32px;font-family:'Rubik',sans-serif;\">Let's log you in!</h1>\r\n                      <p style=\"font-size:15px; color:#455056; margin:8px 0 0; line-height:24px;\"> Use this code to sign in for ${process.env.ORG_NAME} </p>\r\n                      <p style=\"display:inline-block; font-weight:500; margin-top:24px;text-transform:uppercase; font-size:55px;\">${otp}</p>\r\n                      <p style=\"font-size:12px;\">This code will sign you in using <span style=\"color: blue;\"> ${to}</span></p>\r\n                      <p style=\"font-size:10px; padding-top: 24px;\">If you didn't request this email, you can safely ignore it.</p>\r\n                    </td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td style=\"height:40px;\">&nbsp;</td>\r\n                  </tr>\r\n                </table>\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"height:20px;\">&nbsp;</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"height:80px;\">&nbsp;</td>\r\n            </tr>\r\n          </table>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n  </body>\r\n</html>\r\n`;\r\n\r\n  const textPart = `\r\nLet's log you in!\r\n\r\nUse this code to sign in for ${process.env.ORG_NAME}: ${otp}\r\n\r\nThis code will securely sign you up using ${to}\r\n\r\nThis code is valid for 5 minutes.\r\n\r\nIf you didn't request this email, you can safely ignore it.\r\n`;\r\n\r\n  // email params\r\n  const params = {\r\n    Destination: {\r\n      ToAddresses: [to],\r\n    },\r\n    Message: {\r\n      Body: {\r\n        Html: {\r\n          Charset: 'UTF-8',\r\n          Data: htmlPart,\r\n        },\r\n        Text: {\r\n          Charset: 'UTF-8',\r\n          Data: textPart,\r\n        },\r\n      },\r\n      Subject: {\r\n        Charset: 'UTF-8',\r\n        Data: subjectPart,\r\n      },\r\n    },\r\n    Source: `otp@${process.env.CLIENT_EMAIL}`,\r\n  };\r\n\r\n  // Create the CreateTemplateCommand\r\n  const sendEmailCommand = new SendEmailCommand(params);\r\n\r\n  // Function to create the email template\r\n  await sesClient\r\n    .send(sendEmailCommand)\r\n    .then(res => null)\r\n    .catch(err => logger.error(err));\r\n};\r\n\r\n// <tr>\r\n//   <td style=\"text-align:center;\">\r\n//     <p style=\"font-size:14px; color:rgba(69, 80, 86, 0.7411764705882353); line-height:18px; margin:0 0 0;\">Powered by &copy; <strong>CredBrick</strong>\r\n//     </p>\r\n//   </td>\r\n// </tr>\r\n"]}